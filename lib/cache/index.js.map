{"version":3,"sources":["../../src/cache/index.js"],"names":[],"mappings":";;;;;;;;sBAAmB,UAAU;;;;qBAEd;AACb,KAAG,EAAE,aAAC,IAAI,EAAE,EAAE,EAAK;AACjB,QAAI,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,EAAE,EAAE,CAAC;;AAE7B,QAAI,KAAK,GAAG,oBAAO,GAAG,CAAC,IAAI,CAAC,CAAC;;AAE7B,QAAI,KAAK,CAAC,QAAQ,EAAE;AAClB,WAAK,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AAC3B,aAAO,EAAE,EAAE,CAAC;KACb;;AAED,SAAK,CAAC,GAAG,CAAC,UAAC,GAAG,EAAE,IAAI,EAAK;AACvB,UAAI,GAAG,EAAE;AACP,eAAO,EAAE,CAAC,GAAG,CAAC,CAAC;OAChB;;AAED,UAAI,CAAC,IAAI,EAAE;AACT,eAAO,EAAE,EAAE,CAAC;OACb;;AAED,UAAI,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,SAAS,EAAE;AACrC,aAAK,CAAC,MAAM,yBAAuB,IAAI,CAAC,SAAS,0BAAqB,IAAI,CAAC,SAAS,OAAI,CAAC;AACzF,aAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAChB,eAAO,EAAE,EAAE,CAAC;OACb;;AAED,QAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;KAChB,CAAC,CAAC;GACJ;AACD,KAAG,EAAE,aAAC,IAAI,EAAE,IAAI,EAAK;AACnB,QAAI,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO;;AAExB,QAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC;AAC1B,QAAI,KAAK,GAAG,oBAAO,GAAG,CAAC,IAAI,CAAC,CAAC;AAC7B,SAAK,CAAC,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;GAC3B;AACD,OAAK,EAAE,iBAAM;;AAEX,wBAAO,KAAK,EAAE,CAAC;GAChB;AACD,SAAO,qBAAQ;CAChB","file":"index.js","sourcesContent":["import caches from './caches';\n\nexport default {\n  get: (opts, cb) => {\n    if (!opts.cache) return cb();\n\n    let cache = caches.get(opts);\n\n    if (cache.delegate) {\n      cache.logger('delegating');\n      return cb();\n    }\n\n    cache.get((err, data) => {\n      if (err) {\n        return cb(err);\n      }\n\n      if (!data) {\n        return cb();\n      }\n\n      if (data.buildHash !== opts.buildHash) {\n        cache.logger(`cached build hash \"${data.buildHash}\" does not match \"${opts.buildHash}\"`);\n        cache.set(null);\n        return cb();\n      }\n\n      cb(null, data);\n    });\n  },\n  set: (opts, data) => {\n    if (!opts.cache) return;\n\n    let delegate = opts.watch;\n    let cache = caches.get(opts);\n    cache.set(data, delegate);\n  },\n  clear: () => {\n    // Purges the memory cache, but leaves the file system intact\n    caches.clear();\n  },\n  _caches: caches\n};\n"]}